#!/usr/bin/env python3
"""
üéØ ANALYTICS DEMO RUNNER
=======================
Quick demonstration of institutional-grade analytics capabilities

This script provides a streamlined way to experience the full power of the
AIA Analytics Platform with sample data and comprehensive demonstrations.
"""

import sys
import time
import json
import webbrowser
import threading
from datetime import datetime
from pathlib import Path

def print_header():
    """Print demo header"""
    print("""
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                                               ‚ïë
‚ïë               üéØ AIA ANALYTICS PLATFORM DEMO                                   ‚ïë
‚ïë                                                                               ‚ïë
‚ïë    Institutional-Grade Business Intelligence Demonstration                     ‚ïë
‚ïë                                                                               ‚ïë
‚ïë  üí∞ Monte Carlo Financial Projections ($42.8M ‚Üí $1.8B)                       ‚ïë
‚ïë  üìà Hybrid ARIMA-LSTM Market Forecasting                                     ‚ïë
‚ïë  üë• Advanced Customer LTV/CAC Analytics                                       ‚ïë
‚ïë  üîÑ Real-Time Business Intelligence Dashboard                                  ‚ïë
‚ïë  üéØ Executive Presentation Generation                                          ‚ïë
‚ïë  ‚ö†Ô∏è Comprehensive Risk Assessment                                             ‚ïë
‚ïë                                                                               ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
    """)

def run_institutional_analysis():
    """Run the institutional analytics system"""
    print("üè¢ Running Institutional Analytics Analysis...")

    try:
        from institutional_analytics_system import main as institutional_main
        institutional_main()
        return True
    except Exception as e:
        print(f"‚ùå Institutional analytics failed: {e}")
        return False

def run_realtime_demo():
    """Run real-time business intelligence demo"""
    print("üîÑ Starting Real-Time Business Intelligence Demo...")

    def start_realtime():
        try:
            from real_time_business_intelligence import main as realtime_main
            realtime_main()
        except Exception as e:
            print(f"‚ùå Real-time system failed: {e}")

    # Start in background thread
    thread = threading.Thread(target=start_realtime, daemon=True)
    thread.start()

    print("‚úÖ Real-time dashboard starting at http://localhost:8051")
    time.sleep(3)
    return True

def run_presentation_demo():
    """Run executive presentation demo"""
    print("üéØ Generating Executive Presentation...")

    try:
        from executive_presentation_system import main as presentation_main

        # Start in background thread
        def start_presentation():
            presentation_main()

        thread = threading.Thread(target=start_presentation, daemon=True)
        thread.start()

        print("‚úÖ Executive presentation starting at http://localhost:8052")
        time.sleep(3)
        return True
    except Exception as e:
        print(f"‚ùå Presentation system failed: {e}")
        return False

def run_comprehensive_demo():
    """Run comprehensive analytics demo"""
    print("üéº Starting Comprehensive Analytics Demo...")

    results = {}

    # Step 1: Institutional Analysis
    print("\n" + "="*80)
    print("STEP 1: INSTITUTIONAL FINANCIAL ANALYSIS")
    print("="*80)

    if run_institutional_analysis():
        results['institutional'] = True
        print("‚úÖ Institutional analysis completed")
    else:
        results['institutional'] = False
        print("‚ùå Institutional analysis failed")

    # Step 2: Real-Time Dashboard
    print("\n" + "="*80)
    print("STEP 2: REAL-TIME BUSINESS INTELLIGENCE")
    print("="*80)

    if run_realtime_demo():
        results['realtime'] = True
        print("‚úÖ Real-time dashboard launched")
    else:
        results['realtime'] = False
        print("‚ùå Real-time dashboard failed")

    # Step 3: Executive Presentations
    print("\n" + "="*80)
    print("STEP 3: EXECUTIVE PRESENTATION SYSTEM")
    print("="*80)

    if run_presentation_demo():
        results['presentation'] = True
        print("‚úÖ Executive presentation launched")
    else:
        results['presentation'] = False
        print("‚ùå Executive presentation failed")

    return results

def open_browser_tabs():
    """Open browser tabs for demo"""
    urls = [
        "http://localhost:8051",  # Real-time dashboard
        "http://localhost:8052",  # Executive presentation
    ]

    print("üåê Opening browser tabs for demo...")
    for url in urls:
        try:
            webbrowser.open(url)
            time.sleep(1)
        except Exception as e:
            print(f"‚ö†Ô∏è Could not open {url}: {e}")

def wait_for_user_input():
    """Wait for user interaction"""
    print("\n" + "="*80)
    print("DEMO SERVICES ACTIVE")
    print("="*80)
    print("üìä Real-Time Dashboard: http://localhost:8051")
    print("üéØ Executive Presentation: http://localhost:8052")
    print("üìã Comprehensive analysis results saved to JSON files")
    print("\nüí° Explore the dashboards and presentations in your browser")
    print("Press Enter to stop the demo or Ctrl+C to exit...")

    try:
        input()
        print("üõë Stopping demo services...")
    except KeyboardInterrupt:
        print("\nüõë Demo interrupted by user")

def generate_demo_summary(results: dict):
    """Generate demo summary report"""
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")

    summary = {
        "demo_timestamp": timestamp,
        "demo_results": results,
        "success_rate": sum(results.values()) / len(results) if results else 0,
        "components_tested": list(results.keys()),
        "recommendations": [
            "Review generated JSON files for detailed analytics results",
            "Explore interactive dashboards in browser",
            "Examine executive presentation slides",
            "Consider production deployment for enterprise use"
        ],
        "next_steps": [
            "Customize analytics parameters for your business",
            "Integrate with your data sources",
            "Deploy in production environment",
            "Schedule regular analysis runs"
        ]
    }

    summary_file = f"/Users/wXy/dev/Projects/aia/analytics/demo_summary_{timestamp}.json"
    with open(summary_file, 'w') as f:
        json.dump(summary, f, indent=2)

    print(f"üìã Demo summary saved: {summary_file}")
    return summary

def main():
    """Main demo execution"""
    print_header()

    print("üöÄ Welcome to the AIA Analytics Platform Demo!")
    print("\nThis demonstration will showcase:")
    print("  ‚Ä¢ Advanced financial modeling with Monte Carlo simulations")
    print("  ‚Ä¢ Real-time business intelligence monitoring")
    print("  ‚Ä¢ Executive presentation generation")
    print("  ‚Ä¢ Comprehensive risk assessment")
    print("  ‚Ä¢ Customer analytics and market intelligence")

    print("\n‚è±Ô∏è Estimated demo time: 5-10 minutes")
    print("üíª System requirements: Python 3.8+, 4GB RAM, modern web browser")

    # Get user confirmation
    print("\nPress Enter to start the demo or Ctrl+C to exit...")
    try:
        input()
    except KeyboardInterrupt:
        print("\nüëã Demo cancelled by user")
        sys.exit(0)

    # Check if we're in the right directory
    current_dir = Path.cwd()
    analytics_files = [
        'institutional_analytics_system.py',
        'real_time_business_intelligence.py',
        'executive_presentation_system.py'
    ]

    missing_files = []
    for file in analytics_files:
        if not (current_dir / file).exists():
            missing_files.append(file)

    if missing_files:
        print(f"‚ùå Missing required files: {missing_files}")
        print("Please run this script from the analytics directory")
        sys.exit(1)

    # Run comprehensive demo
    print("\nüéØ Starting comprehensive analytics demonstration...")
    results = run_comprehensive_demo()

    # Open browser tabs
    time.sleep(2)
    open_browser_tabs()

    # Wait for user interaction
    wait_for_user_input()

    # Generate summary
    summary = generate_demo_summary(results)

    # Final report
    print("\n" + "="*80)
    print("DEMO COMPLETION REPORT")
    print("="*80)

    success_count = sum(results.values())
    total_count = len(results)
    success_rate = (success_count / total_count * 100) if total_count > 0 else 0

    print(f"‚úÖ Components tested: {total_count}")
    print(f"‚úÖ Successful demonstrations: {success_count}")
    print(f"üìä Success rate: {success_rate:.1f}%")

    if success_rate >= 80:
        print("\nüéâ DEMO COMPLETED SUCCESSFULLY!")
        print("The AIA Analytics Platform is ready for enterprise deployment.")
    elif success_rate >= 60:
        print("\n‚ö†Ô∏è DEMO PARTIALLY SUCCESSFUL")
        print("Some components may need troubleshooting for production use.")
    else:
        print("\n‚ùå DEMO NEEDS ATTENTION")
        print("Multiple components failed. Check system requirements and dependencies.")

    print("\nüìã Files generated:")
    for file in Path.cwd().glob("*_analysis_*.json"):
        print(f"  ‚Ä¢ {file.name}")
    for file in Path.cwd().glob("demo_summary_*.json"):
        print(f"  ‚Ä¢ {file.name}")

    print("\nüí° Next steps:")
    for step in summary['next_steps']:
        print(f"  ‚Ä¢ {step}")

    print("\nüëã Thank you for experiencing the AIA Analytics Platform!")

if __name__ == "__main__":
    main()